<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>天天生鲜-首页</title>
<link rel="short icon" href="front/images/copylogo.png">
<link rel="stylesheet" href="front/css/reset.css">
<link rel="stylesheet" href="front/css/index.css">
<link rel="stylesheet" href="front/css/foot.css">
</head>

<body>
<div id="header">
	<!-- 头部 -->
	<div class="header_con" >
    	<div class="header">
    		<div class="welcome fl">欢迎来到天天生鲜</div>
    		<div class="fr">
            	<div class="login_info fl" v-if="islogin">
                	欢迎：<em>{{nickname}}</em>
                </div>
                <div class="login_btn fl">
                	<a v-if="islogin" href="javascript:void(0)" @click="logout()">退出</a>
                	<a v-else href="../login.html">登录</a>
                    <span> | </span>
                    <a href="../register.html">注册</a>
                </div>
            	 <div class="user_link fl">
                    <span> | </span>
                    <a href="dayFresh/user.html">用户中心</a>
                    <span> | </span>
                    <a :href="'dayFresh/cart.html?mno=' + mno">我的购物车</a>
                    <span> | </span>
                    <a :href="'dayFresh/order.html?mno=' + mno">我的订单</a>
           		 </div> 
             </div>  
    	</div>
    </div>

	<!-- 搜索框-->
	<div class="search_bar clearfix">
    	<a href="index.html" class="logo fl"><img src="../front/images/logo.png"></a>
    	<div class="search_con fl">
        	<form>
            	<input type="text" placeholder="搜索商品" class="input_text fl" v-model="searchinfo" name="key_words">
                <input type="button" value="搜索" @click="toSearch"  class="input_btn fr">
            </form>
        </div>
    	<div class="guest_cart fr">
        	<a :href="'dayFresh/cart.html?mno=' + mno" class="cart_name fl">我的购物车</a>
            <div class="goods_count fl" id="show_count">{{cartnum}}</div>
        </div>
    </div>
</div>  
    <!-- 商品分类 -->
    <div class="navbar_con">
    	<div class="navbar">
    		<h1 class="fl">全商品分类</h1>
    		<ul class="navlist fl">
    			<li><a href="">首页</a></li>
                <li class="interval">|</li>
                <li><a href="">手机生鲜</a></li>
                <li class="interval">|</li>
                <li><a href="">抽奖</a></li>
    		</ul>
    	</div>
    </div>
<div id="goodsDiv">
    <!-- 导航栏 -->
    <div class="center_con clearfix">
        <div class="subnav fl">
            <ul v-for="type in types">
                <li><a :href="'#mode' + type.tno" :class="typeClass[type.tno]">{{type.tname}}</a></li>
            </ul>
        </div>
        <div class="slide fl">
            <ul class="slide_pics">
                <li><a href="../dayFresh/goods.html#tno=1" class=""><img src="front/images/slide.jpg" alt="幻灯片"></a></li>
                <li><a href="../dayFresh/goods.html#tno=1" class=""><img src="front/images/slide02.jpg" alt="幻灯片"></a></li>
                <li><a href="../dayFresh/goods.html#tno=3" class=""><img src="front/images/slide03.jpg" alt="幻灯片"></a></li>
                <li><a href="../dayFresh/goods.html#tno=2" class=""><img src="front/images/slide04.jpg" alt="幻灯片"></a></li>
            </ul>
            <div class="prev"></div>
            <div class="next"></div>
            <ul class="points"></ul>
        </div>
        <div class="adv fl">
            <a href="dayFresh/searchgoods.html"><img src="front/images/adv01.jpg" alt="清凉一夏"></a>
            <a href=""><img src="front/images/adv02.jpg" alt="盛夏尝鲜"></a>
        </div>
    </div>
    
    <!-- 商品展示 -->
    <div class="list_model" v-for="type in types">
    	<div class="list_title clearfix">
        	<h3 class="fl" :id="'mode' + type.tno">{{type.tname}}</h3>
        	<div class="subtitle fl">
            	<span>|</span>
                <a :href="'dayFresh/details.html#gno=' + good.gno + '&tno=' + type.tno" v-for="good in goods" v-if="good.tno == type.tno">{{good.gname}}</a>
            </div>
            <a :href="'dayFresh/goods.html?tno=' + type.tno" class="goods_more fr" id="fruit_more">查看更多</a>
        </div>
    
    	<div class="goods_con clearfix">
        	<div class="goods_banner fl"><img :src="'front/images/' + type.pic"></div>
        	<ul class="goods_list fl">
            	<li v-for="good in goods" v-if="good.tno == type.tno">
                	<h4><a :href="'dayFresh/details.html#gno=' + good.gno + '&tno=' + type.tno">{{good.gname}}</a></h4>
                    <a :href="'dayFresh/details.html#gno=' + good.gno + '&tno=' + type.tno"><img :src="good.pics"></a>
                	<div class="prize">&yen; {{good.price}}</div>
                </li>
        	</ul>
        </div>
    </div>	
</div>  
    <!-- 版权所有 -->
    <div class="footer">
    	<div class="foot_link">
        	<a href="#">关于我们</a> <span> | </span>
            <a href="#">联系我们</a> <span> | </span>
            <a href="#">招聘广告</a> <span> | </span>
            <a href="#">友情链接</a>
        </div>
    	<p>CopyRight &copy; 2019 衡阳市源辰信息科技有限公司 All Rights Reserverd</p>
        <p>电话：0734-8355998 湘ICP备16015987号-1</p>
    </div>
<!--  注意引入顺序 -->
<script src="front/js/jquery-3.4.1.min.js"></script>
<script src="front/js/jquery-ui.min.js"></script>
<script src="front/js/slide.js"></script>
    
<script type="text/javascript" src="backer/js/vue@2.6.11.js"></script>
<script type="text/javascript" src="backer/js/axios.min.js"></script>
<!--  
<script src="../front/js/check.js"></script>   
-->   
<script>

	var goodsdiv = new Vue({
		el: "#goodsDiv",
		data: {
			types: [],
			typeClass: ["0","fruit", "seafood", "meet", "egg", "vegetables", "ice"],
			goods: []
			
		},
		mounted: function() {
			this.findGoods(); // 页面加载后 查询商品信息
		},
		methods: {
			findGoods: function() {
				axios({
					url: "frontgoods/findGoods",
					method: "post"
				})
				.then(result => {
					console.info(result.data);
					this.types = result.data.types;
					this.goods = result.data.goods;
					this.goods.forEach((item, index) => {
						let pic = item.pics.substring(0, item.pics.indexOf(";"));
						// 第一个参数是要修改的数据, 第二个值是修改当前数组的哪一个字段,第三个是要修改为什么值
						Vue.set(this.goods[index], 'pics', pic);
					})
				})
				.catch(function(e) {
					alert("加载前台商品信息失败，请联系管理员...\n" + e)
				})
			}
		}
	})
    </script>  
</body>
</html>
